{% extends "base.html" %}
{% block content %}
<div class="card text-center mb-4 shadow-sm border-primary"><div class="card-header bg-primary text-white fw-bold">ğŸ§¹ ESCOBA DEL DÃA ({{ hoy_dia }})</div><div class="card-body"><h1 class="display-3 fw-bold text-dark">{{ escoba_actual }}</h1>{% if user.role == 'Supervisor' %}<form action="/admin/next_turn" method="POST" class="mt-3"><button type="submit" class="btn btn-danger" onclick="return confirm('Â¿Confirmar rotaciÃ³n?')">ğŸ”„ CALCULAR SIGUIENTE</button></form>{% endif %}</div></div>
{% if user.role == 'Conductor' %}<div class="card mb-4 shadow border-warning"><div class="card-body d-flex justify-content-between align-items-center"><div><h5 class="mb-1">{{ user.name }}</h5><small class="text-muted">DÃ­as Off: {{ user.fixed_days_off }}</small></div><form action="/update_status" method="POST"><select name="status" class="form-select fw-bold form-select-sm" onchange="this.form.submit()"><option value="Activo" {% if user.current_status == 'Activo' %}selected{% endif %}>ğŸŸ¢ Activo</option><option value="Vacaciones" {% if user.current_status == 'Vacaciones' %}selected{% endif %}>âœˆï¸ Vacaciones</option><option value="Baja Laboral" {% if user.current_status == 'Baja Laboral' %}selected{% endif %}>ğŸš‘ Baja</option><option value="Libre" {% if user.current_status == 'Libre' %}selected{% endif %}>ğŸ”µ Asuntos</option></select></form></div></div>{% endif %}
<h6 class="text-muted text-uppercase small fw-bold mb-3">Cola de RotaciÃ³n (AntigÃ¼edad)</h6><div class="row">{% for d in drivers %}<div class="col-12 col-md-6 mb-2"><div class="card h-100 {% if d.name == escoba_actual %}border-success bg-light{% endif %}"><div class="card-body p-2 d-flex justify-content-between align-items-center"><div><div class="fw-bold">{{ d.name }}</div><div class="small text-muted">Ãšltima vez: {% if d.last_escoba_date %}<span class="text-dark fw-bold">{{ d.last_escoba_date.strftime('%d/%m') }}</span>{% else %}<span class="text-danger fw-bold">NUNCA</span>{% endif %}</div></div><div class="text-end">{% if d.name == escoba_actual %}<span class="fs-3">ğŸ§¹</span>{% else %}<span class="badge {% if d.current_status == 'Activo' %}bg-success{% else %}bg-secondary{% endif %}">{{ d.current_status }}</span><div class="small text-muted mt-1" style="font-size: 0.7rem;">{{ d.fixed_days_off }}</div>{% endif %}</div></div></div></div>{% endfor %}</div>
{% if user.role == 'Supervisor' %}<hr class="mt-5"><div class="accordion" id="accordionPin"><div class="accordion-item border-danger"><h2 class="accordion-header"><button class="accordion-button collapsed bg-danger text-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePin">ğŸ‘®â€â™‚ï¸ CÃ“DIGOS PIN</button></h2><div id="collapsePin" class="accordion-collapse collapse"><div class="accordion-body p-0"><table class="table table-striped table-sm mb-0 text-center small"><thead class="table-dark"><tr><th>Nombre</th><th>PIN</th><th>Email</th></tr></thead><tbody>{% for d in drivers %}<tr><td class="text-start fw-bold">{{ d.name }}</td><td class="font-monospace text-danger fw-bold fs-6">{{ d.signup_pin }}</td><td>{{ "âœ…" if d.is_registered else "âŒ" }}</td></tr>{% endfor %}</tbody></table></div></div></div></div>{% endif %}
{% endblock %}